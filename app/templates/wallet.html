{% extends "base.html" %}

{% block title %}Wallet - CinemaMax{% endblock %}

{% block content %}
<div class="container mx-auto px-6 py-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8 text-center">My Wallet</h1>
        
        <!-- Wallet Balance Card -->
        <div class="bg-gradient-to-r from-yellow-600 to-yellow-500 p-8 rounded-xl mb-8 shadow-lg">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-yellow-100 text-lg font-medium">Current Balance</p>
                    <p class="text-5xl font-bold text-white mb-2">${{ "%.2f"|format(current_user.wallet_balance) }}</p>
                    <p class="text-yellow-200 text-sm">Available for movie bookings</p>
                </div>
                <div class="text-yellow-100">
                    <i class="fas fa-wallet text-6xl"></i>
                </div>
            </div>
        </div>
        
        <!-- Wallet Information -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- How it Works -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-bold mb-4 gold-accent flex items-center">
                    <i class="fas fa-info-circle mr-3"></i>How Your Wallet Works
                </h2>
                
                <div class="space-y-4">
                    <div class="flex items-start">
                        <div class="bg-yellow-600 rounded-full p-2 mr-4 mt-1">
                            <i class="fas fa-gift text-white text-sm"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-yellow-400">Welcome Bonus</h3>
                            <p class="text-gray-300 text-sm">New users receive $200 credit upon registration</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="bg-green-600 rounded-full p-2 mr-4 mt-1">
                            <i class="fas fa-ticket-alt text-white text-sm"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-green-400">Easy Booking</h3>
                            <p class="text-gray-300 text-sm">Use your wallet balance to book movie tickets instantly</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="bg-blue-600 rounded-full p-2 mr-4 mt-1">
                            <i class="fas fa-shield-alt text-white text-sm"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-blue-400">Secure & Fast</h3>
                            <p class="text-gray-300 text-sm">No need to enter payment details for each booking</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Payment Gateway Status -->
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-bold mb-4 text-red-400 flex items-center">
                    <i class="fas fa-exclamation-triangle mr-3"></i>Payment Gateway Status
                </h2>
                
                <div class="space-y-4">
                    <div class="bg-red-900 border border-red-500 p-4 rounded-lg">
                        <h3 class="font-semibold text-red-200 mb-2">Credit Card Payments Unavailable</h3>
                        <p class="text-red-300 text-sm mb-3">
                            Our payment gateway is currently experiencing technical difficulties. 
                            We're working to resolve this issue as quickly as possible.
                        </p>
                        <div class="flex items-center text-red-200 text-sm">
                            <i class="fas fa-clock mr-2"></i>
                            <span>Estimated resolution: 24-48 hours</span>
                        </div>
                    </div>
                    
                    <div class="bg-green-900 border border-green-500 p-4 rounded-lg">
                        <h3 class="font-semibold text-green-200 mb-2">Wallet Payments Available</h3>
                        <p class="text-green-300 text-sm">
                            You can continue booking movies using your wallet balance. 
                            All transactions are processed instantly and securely.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Recent Transactions (if you want to add this later) -->
        <div class="mt-8">
            <div class="bg-gray-800 p-6 rounded-lg">
                <h2 class="text-xl font-bold mb-4 gold-accent flex items-center">
                    <i class="fas fa-history mr-3"></i>Recent Activity
                </h2>
                
                {% if current_user.bookings %}
                    <div class="space-y-3">
                        {% for booking in current_user.bookings[:5] %}
                        <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                            <div>
                                <p class="font-semibold">{{ booking.showtime.movie.title }}</p>
                                <p class="text-gray-400 text-sm">{{ booking.booking_date.strftime('%b %d, %Y at %I:%M %p') }}</p>
                            </div>
                            <div class="text-right">
                                <p class="text-red-400 font-semibold">-${{ "%.2f"|format(booking.total_price) }}</p>
                                <p class="text-gray-400 text-sm">Wallet Payment</p>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="text-center py-8">
                        <i class="fas fa-ticket-alt text-gray-600 text-4xl mb-4"></i>
                        <p class="text-gray-400">No recent transactions</p>
                        <p class="text-gray-500 text-sm">Your wallet activity will appear here</p>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Admin Controls (if user is admin) -->
        {% if current_user.is_admin %}
        <div class="mt-8">
            <div class="bg-purple-900 border border-purple-500 p-6 rounded-lg">
                <h2 class="text-xl font-bold mb-4 text-purple-200 flex items-center">
                    <i class="fas fa-user-shield mr-3"></i>Admin Controls
                </h2>
                
                <form method="POST" action="{{ url_for('add_wallet_balance') }}" class="flex items-center space-x-4">
                    <input type="number" name="amount" step="0.01" min="1" max="1000" 
                           placeholder="Amount to add" required
                           class="px-4 py-2 bg-gray-700 text-white rounded-lg border border-gray-600 focus:border-purple-400 focus:outline-none">
                    <button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition-colors">
                        <i class="fas fa-plus mr-2"></i>Add Balance
                    </button>
                </form>
                
                <p class="text-purple-300 text-sm mt-2">
                    <i class="fas fa-info-circle mr-1"></i>
                    Admin privilege: Add balance to your wallet for testing purposes
                </p>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<style>
.gold-accent {
    color: #fbbf24;
}
</style>
{% endblock %}